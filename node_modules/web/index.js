var path 	= require('path');
var express = require('express');
var php 	= require('php-node')({bin: __dirname + path.sep + 'php'+ path.sep +'php.exe'});

var app = express();

app.set('views', './htdocs');
app.engine('php', php);
app.set('view engine', 'php');

app.all('/', function(req, res) {
	
	res.render('index');
});

app.all(/.+\.php$/, function(req, res) {
	
	res.render(req.path.slice(1), {
        method: req.method,
        get: req.query,
        post: req.body
    });
});

app.use('/style', express.static('./htdocs/style'));
app.use('/images', express.static('./htdocs/images'));
app.use('/js', express.static('./htdocs/js'));

var server = app.listen(80, function () {
	
	var host = server.address().address;
	var port = server.address().port;
	
	console.log('Server listening at http://%s:%s', host, port);
});